# Дмитрий Воловиков - "LyceumDocBot"

# Пользовательские сценарии

### Группа: 11 - И - 1

### Электронная почта: volovikov.dvs@gmail.com

### Tg: @Pug0077

### Сценарий 1 — Регистрация и вход

1. **Пользователь нажимает** «Регистрация» на странице входа.
2. **Пользователь вводит** email, отображаемое имя и пароль, затем подтверждает пароль.
3. **Система проверяет** формат email и совпадение паролей.
4. **Система создаёт** аккаунт и **показывает** сообщение об успешной регистрации.
5. **Пользователь вводит** email и пароль на странице входа и **нажимает** «Войти».
6. **Система создаёт** сессию и **перенаправляет** пользователя в основной раздел приложения.
7. **Система показывает** ошибку, если email/пароль неверны, и **предлагает** повторить ввод.
8. **Пользователь повторяет** попытку входа с корректными данными.

### Сценарий 2 — Вопрос в чате

1. **Пользователь вводит** вопрос в поле чата и **нажимает** «Отправить».
2. **Система проверяет** запрос (не пустой и в пределах длины).
3. **Система показывает** ошибку, если запрос некорректен, и **не отправляет** его в обработку.
4. **Система создаёт** запись вопроса в базе и **показывает** состояние обработки.
5. **Система выполняет** поиск фрагментов документов, связанных с вопросом.
6. **Система формирует** ответ и **показывает** его в чате.
7. **Система показывает** рядом с ответом панель/кнопку «Источники».
8. **Пользователь задаёт** уточняющий вопрос и **отправляет** его следующим сообщением.


### Сценарий 3 — Ответ с источниками и “нет подтверждения”

1. **Пользователь задаёт** вопрос в чате.
2. **Система ищет** релевантные фрагменты в корпусе документов.
3. **Система формирует** список источников `S1..Sk` на основе найденных фрагментов.
4. **Система генерирует** ответ на основе контекста из `S1..Sk`.
5. **Система показывает** пользователю ответ и список источников рядом с ответом.
6. **Система сохраняет** вопрос, ответ и источники в базе данных.
7. **Система показывает** сообщение “не найдено подтверждение в документах”, если релевантных источников нет.
8. **Пользователь уточняет** запрос и **отправляет** его повторно.

### Сценарий 4 — Просмотр источника и переход к документу

1. **Пользователь нажимает** «Источники» рядом с ответом.
2. **Система отображает** список источников `S1..Sk` с названием документа и фрагментом текста.
3. **Пользователь выбирает** источник `S1`.
4. **Система показывает** карточку источника с фрагментом и ссылкой на документ.
5. **Пользователь нажимает** «Открыть документ».
6. **Система открывает** страницу документа с извлечённым текстом/фрагментами.
7. **Система показывает** ошибку, если документ недоступен, и **предлагает** вернуться к источникам.
8. **Пользователь открывает** оригинальный файл документа (если нужно) и сверяет формулировки.

### Сценарий 5 — Поиск по ключевой фразе

1. **Пользователь вводит** ключевую фразу в разделе поиска и **нажимает** «Найти».
2. **Система проверяет** корректность запроса и **показывает** ошибку при нарушении.
3. **Система выполняет** поиск по документам и **формирует** список совпадений.
4. **Система показывает** результаты со сниппетами и названием документа.
5. **Пользователь открывает** один из результатов.
6. **Система открывает** страницу документа и **показывает** извлечённый текст/фрагменты.
7. **Система показывает** “ничего не найдено”, если результатов нет, и **предлагает** изменить запрос.
8. **Пользователь меняет** запрос и **повторяет** поиск.

### Сценарий 6 — История и повторная обработка

1. **Пользователь открывает** раздел «История».
2. **Система показывает** список прошлых запросов пользователя.
3. **Пользователь выбирает** один запрос из списка.
4. **Система отображает** сохранённый ответ и источники без повторной генерации.
5. **Пользователь нажимает** «Повторить/Обновить ответ».
6. **Система заново выполняет** поиск фрагментов и генерацию ответа.
7. **Система сохраняет** новую версию ответа и **показывает** её пользователю.
8. **Система показывает** ошибку и кнопку повторной попытки, если обработка не удалась.
9. **Пользователь повторяет** попытку или возвращается к истории.

### Сценарий 7 — Экспорт ответа

1. **Пользователь открывает** ответ в чате или в истории.
2. **Пользователь нажимает** «Экспорт в PDF».
3. **Система собирает** данные (вопрос, ответ, список источников).
4. **Система генерирует** PDF-файл с разделами “Вопрос”, “Ответ”, “Источники”.
5. **Система возвращает** PDF пользователю для скачивания.
6. **Пользователь скачивает** файл на устройство.
7. **Система показывает** ошибку, если генерация PDF не удалась, и **предлагает** повторить экспорт.
8. **Пользователь повторяет** экспорт или возвращается к ответу.

### Сценарий 8 — Загрузка и индексация документа

1. **Администратор открывает** раздел «Документы» в админ-панели.
2. **Администратор нажимает** «Загрузить документ» и выбирает файл.
3. **Администратор вводит** название документа и **подтверждает** загрузку.
4. **Система сохраняет** файл и **создаёт** запись документа со статусом `indexing`.
5. **Система извлекает** текст и **разбивает** его на фрагменты.
6. **Система обновляет** поисковые индексы для чата/поиска.
7. **Система переводит** документ в статус `review` при успешной обработке.
8. **Система переводит** документ в статус `error` и **показывает** причину при сбое.
9. **Администратор запускает** повторную обработку для документа со статусом `error`.

### Сценарий 9 — Модерация документа

1. **Администратор открывает** раздел «Модерация».
2. **Система показывает** документы со статусом `review`.
3. **Администратор открывает** карточку документа для проверки.
4. **Администратор нажимает** «Опубликовать» или «Отклонить».
5. **Система требует** причину отклонения и **не завершает** действие без причины.
6. **Система переводит** документ в `published` или `rejected` и обновляет список.
7. **Система показывает** ошибку доступа, если действие выполняет не администратор.
8. **Администратор нажимает** «Удалить документ» и подтверждает удаление.
9. **Система удаляет** файл и связанные данные и **обновляет** интерфейс.

### Сценарий 10 — Роли, блокировка и сброс пароля. 

1. **Администратор открывает** раздел «Пользователи».
2. **Система отображает** список пользователей с ролями и статусами.
3. **Администратор открывает** карточку пользователя по email.
4. **Администратор меняет** роль пользователя и **сохраняет** изменения.
5. **Система запрещает** снять роль у последнего администратора и **показывает** ошибку.
6. **Администратор блокирует/разблокирует** пользователя и подтверждает действие.
7. **Администратор нажимает** «Сбросить пароль» и подтверждает.
8. **Система генерирует** временный пароль и **включает** требование смены пароля при первом входе.
9. **Система показывает** временный пароль администратору.
10. **Пользователь входит** по временному паролю, а **система переводит** его на смену пароля и не даёт продолжить работу до смены.

